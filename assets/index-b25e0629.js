import{L as V,h as M,p as T,B as ue,C as E,v as c,z as w,t as d,ap as ce,ak as me,aa as pe,as as fe,aJ as he,aK as ye,a2 as H,am as ve,q as L,af as q,R as g,aB as G,M as Y,O as ee,aR as ge,aS as be,s as Se}from"./index-0dd824e6.js";import{m as we,E as xe}from"./el-select-39f31b62.js";import{C as j}from"./index-5aeacbae.js";import{_ as De}from"./next-7e61d839.js";import{e as _e,c as $e}from"./index-f7adadce.js";import{V as ze}from"./index.min-37d35eff.js";const ke=c("span",{class:"dialog-footer"},null,-1),Ce={__name:"dialog",props:["dialogVisible","data"],emits:["closeDialog"],setup(Q,{emit:o}){const f=Q;let z=V();async function R(){ze.preview(z.value,`

`+Z.value)}function _(p){if(!p)return"0.00";var p=Math.round(parseFloat(p)*100)/100,v=p.toString().split(".");if(v.length==1)return p=p.toString()+".00",p;if(v.length>1)return v[1].length<2&&(p=p.toString()+"0"),p}M(()=>f.dialogVisible);function P(k,p=0){let v=`
`;const B=y=>"  ".repeat(y);for(const[y,C]of Object.entries(k))typeof C=="object"&&C!==null?(v+=`${B(p)}- **${y}**
`,v+=P(C,p+1)):v+=`${B(p)}- ${y}: ${C}
`;return v}function U(k){return new Date(k).toISOString()}let Z=M(()=>{let k=()=>{let v="";for(const B in f.data.resources){const y=f.data.resources[B];v+=`The resource with ID ${y.resourceId} was originally planned to have ${_(y.plannedUnits)} units. The initial planned usage rate was ${_(y.plannedUnitsPerHour)} units per hour, and it currently remains at ${_(y.Units)} units per hour. However, after optimization, the new usage rate is ${_(y.newUnitsPerHour)} units per hour, and the new daily usage is ${_(y.newUnitsPerDay)} units per day.
`}return v};return`This is a task named '${f.data.name}' categorized as '${f.data.type}', and it is ${f.data.critical==!0?"":"not"} a Critical Task.
   Before optimization,
   it is scheduled to start on ${U(f.data.plannedStart).replace("T"," ").replace("Z","").slice(0,16)} (date) and finish on ${U(f.data.plannedFinish).replace("T"," ").replace("Z","").slice(0,16)} (date), with an estimated duration of ${f.data.remainingDuration} hours. 
  After optimization,
   it is scheduled to start on ${U(f.data.newStart).replace("T"," ").replace("Z","").slice(0,16)} (date) and finish on ${U(f.data.newFinish).replace("T"," ").replace("Z","").slice(0,16)} (date), with an estimated duration of ${f.data.newDuration} hours. 
Resources:
${k()}As of now, the task has not commenced and is labeled as '${f.data.status}.' The task's duration ratio is ${_(f.data.durationRatio)}.`+P(f.data)});const x=()=>{o("closeDialog")};return(k,p)=>{const v=ce;return T(),ue(v,{onOpen:R,onClose:x,modelValue:f.dialogVisible,"onUpdate:modelValue":p[0]||(p[0]=B=>f.dialogVisible=B),title:"Detailed content",width:"50%",draggable:""},{footer:E(()=>[ke]),default:E(()=>[c("span",null,w(d(Z).id),1),c("div",{ref_key:"editorRef",ref:z},null,512)]),_:1},8,["modelValue"])}}};const Ie={class:"contain"},Oe={class:"box"},Ne={class:"sp"},Re={class:"step"},Be={class:"step"},Ve={class:"maintop"},Fe={class:"mainEchar1"},Me={class:"Echar1top"},Ue=ge('<div class="choosebox" data-v-01e26f3a><div class="choose" data-v-01e26f3a><div style="background-color:#b0e054;" class="item" data-v-01e26f3a></div><div data-v-01e26f3a>Optimized</div></div><div class="choose" data-v-01e26f3a><div style="background-color:#5474c4;" class="item" data-v-01e26f3a></div><div data-v-01e26f3a>Baseline</div></div><div class="choose" data-v-01e26f3a><div style="background-color:red;" class="item" data-v-01e26f3a></div><div data-v-01e26f3a>Critical Path</div></div><div class="choose" data-v-01e26f3a><div style="background-color:pink;" class="item" data-v-01e26f3a></div><div data-v-01e26f3a>Critical Path(Baseline)</div></div></div><div id="main" data-v-01e26f3a></div>',2),Ae={ref:"main",style:{width:"1350px",height:"610px"},id:"myEcharts"},Te={class:"mainEchar2"},Ee={class:"Echar2top"},Pe={class:"resources-title"},Ze={class:"types"},Je={ref:"main01",style:{width:"1350px",height:"610px"},id:"myEcharts01"},Le={class:"button"},He={__name:"index",setup(Q){const o=pe(),f=fe();let z=V("Compare"),R=V("Date"),_=V(!1),P=V("");const U=()=>{_.value=!1};he((t,a,n)=>{t.name=="InputData",n()}),ye(()=>{o.selectChange&&(I.value="",te(),W(),o.selectChange=!1)});function Z(t,a){return Math.round(t/a*1e4)/100+"%"}function x(t){return new Date(t).toISOString()}function k(t){const a=new Date(t);return`${a.getUTCFullYear()}/${a.getUTCMonth()+1}/${a.getUTCDate()} ${("0"+a.getUTCHours()).slice(-2)}:${("0"+a.getUTCMinutes()).slice(-2)}:${("0"+a.getUTCSeconds()).slice(-2)}`}const p=t=>t[0]===void 0||t[0].length===0?[]:t[0].xy.map(a=>{const[n,s]=Object.entries(a)[0];return{value:[x(parseInt(n)),s],name:x(parseInt(n))+s+t[1]}});let v=_e,B=V(2),y;M(()=>o.selectedData?o.selectedData.baselineTasks.filter(a=>a.critical):void 0);function C(t){return`<span >${t}</span>`}var b,D;function te(){z.value="Compare",b=[],D=o.selectedData.baselineTasks.map((e,l)=>{let u=o.selectedData.tasks.find(r=>r.id===e.id);u.old=e,b.push(u);function m(r){return r===1?1:r+(r-1)*2}return l=m(o.selectedData.baselineTasks.length-l),{name:e.name,value:[l,x(e.newStart),x(e.newFinish),e,{baseNew:{start:e.newStart,finish:e.newFinish,duration:e.newDuration},changeNew:{start:u.newStart,finish:u.newFinish,duration:u.newDuration}}],itemStyle:{color:e.critical?"pink":void 0}}}),b=b.map((e,l)=>{function u(m){return m===2?2:m+(m-2)*2}return l=u(b.length-l+1),{id:e.id,name:e.name,value:[l,x(e.newStart),x(e.newFinish),e,{baseNew:{start:e.old.newStart,finish:e.old.newFinish,duration:e.old.newDuration},changeNew:{start:e.newStart,finish:e.newFinish,duration:e.newDuration}}],itemStyle:{color:e.critical?"red":void 0}}});let t=v.init(document.getElementById("myEcharts"),"purple-passion");t.on("click",function(e){P.value=e.data.value[3],_.value=!0});var a;let n=(e,l)=>{let u=l.coord([l.value(1),l.value(0)]),m=l.coord([l.value(2),l.value(0)]),r=l.size([0,1])[1];return{type:"rect",shape:$e({x:u[0],y:u[1]-r/2,width:Math.max(m[0]-u[0],1),height:r},e.coordSys),style:l.style(),focus:"self",blurScope:"coordinateSystem",emphasis:{}}},s;b.length<30?s=!0:s=!1,a={toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!1},saveAsImage:{show:!0}}},dataZoom:[{type:"slider",filterMode:"weakFilter",xAxisIndex:[0],labelFormatter:function(e){return k(e)},moveHandleSize:15,height:15,moveHandleStyle:{}},{type:"slider",filterMode:"weakFilter",yAxisIndex:[0]},{type:"inside",filterMode:"weakFilter",xAxisIndex:[0]},{type:"inside",filterMode:"weakFilter",yAxisIndex:[0]}],legend:{data:["Baseline","New"]},xAxis:{name:"date",type:"time",splitNumber:5,boundaryGap:[0,0],axisTick:{show:!0,alignWithLabel:!0},minInterval:24*3600,max:function(e){return e.max+(e.max-e.min)*.01},min:function(e){return e.min-(e.max-e.min)*.01},axisLabel:{showMaxLabel:"true",showMinLabel:"true",formatter:function(e,l){return k(e)}}},yAxis:{name:"tasks"},selectedMode:"single",series:[{name:"Baseline",type:"custom",data:D,large:!0,renderItem:n,encode:{x:[1,2],y:0,labal:11},label:{normal:{show:s,color:"black",position:"inside",formatter:function(e){return e.data.name},fontSize:12}}},{name:"New",type:"custom",data:b,large:!0,renderItem:n,encode:{x:[1,2],y:0},label:{normal:{show:s,color:"black",position:"inside",formatter:function(e){return e.data.name},fontSize:12}}}],tooltip:{axisPointer:{},formatter:e=>{let l="Resources: <br/>";if(e.value[3].resources)for(const m in e.value[3].resources){let r=e.value[3].resources,i=o.selectedData.newResources.find(O=>O.id==m);i||(i=""),l+=` &nbsp&nbspResource &nbsp  ${i==null?void 0:i.name} &nbsp id: ${m}  <br/>&nbsp&nbsp&nbsp&nbspunits/hour:${X(r[m].plannedUnitsPerHour)}=> ${X(r[m].newUnitsPerHour)}<br/>`}function u(m){let r;switch(m){case"New":e.value[3].critical?r="red":r="#b0e054";break;case"Old":e.value[3].critical?r="pink":r="#5474c4"}return`<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:${r};"></span>`}return`${e.name}<br/>
        <div style='margin-top:20px'>
         ${u("New")} New: ${C(x(e.value[4].changeNew.start).replace("T"," ").replace("Z","").slice(0,16))} -> ${C(x(e.value[4].changeNew.finish).replace("T"," ").replace("Z","").slice(0,16))}
         (${e.value[4].changeNew.duration})
        <br/>
         ${u("Old")} Old: ${C(x(e.value[4].baseNew.start).replace("T"," ").replace("Z","").slice(0,16))} -> ${C(x(e.value[4].baseNew.finish).replace("T"," ").replace("Z","").slice(0,16))}
       (${e.value[4].baseNew.duration})
         <br/>
         ${l}
        </div>`}}},a&&t.setOption(a),t.off("datazoom"),t.on("datazoom",function(e){F(e,D,b,s)});let h,$;function S(e){return e===2?2:e+(e-2)*2}H(z,(e,l)=>{let u,m;if(R.value=="Date"?(u=h,m=$):(u=D,m=b),e==="Compare"){let r={series:[{name:"Baseline",type:"custom",data:u,large:!0,renderItem:n,encode:{x:[1,2],y:0,labal:11},label:{normal:{show:s,color:"black",position:"inside",formatter:function(i){return i.data.name},fontSize:12}}},{name:"New",type:"custom",data:m,large:!0,renderItem:n,encode:{x:[1,2],y:0},label:{normal:{show:s,color:"black",position:"inside",formatter:function(i){return i.data.name},fontSize:12}}}]};t.setOption(r),t.off("datazoom"),t.on("datazoom",function(i){F(i,D,b,s)})}else{let r=JSON.parse(JSON.stringify(u)).map((N,K)=>{let J={...N};return J.value[0]=D.length*2-K,J}),i=JSON.parse(JSON.stringify(m)).map((N,K)=>{let J={...N};return J.value[0]=D.length-K,J}),O={series:[{name:"Baseline",type:"custom",data:r,large:!0,renderItem:n,encode:{x:[1,2],y:0,labal:11},label:{normal:{show:s,color:"black",position:"inside",formatter:function(N){return N.data.name},fontSize:12}}},{name:"New",type:"custom",data:i,large:!0,renderItem:n,encode:{x:[1,2],y:0},label:{normal:{show:s,color:"black",position:"inside",formatter:function(N){return N.data.name},fontSize:12}}}]};t.setOption(O),t.off("datazoom"),t.on("datazoom",function(N){F(N,r,i,s)})}}),H(R,(e,l)=>{let u=JSON.parse(JSON.stringify(D)),m=JSON.parse(JSON.stringify(b));if(h=u.sort(function(r,i){return r.value[3].plannedFinish-i.value[3].plannedFinish}),h.map((r,i)=>{let O={...r};return O.value[0]=S(D.length-i+1),O}),$=m.sort(function(r,i){return r.value[3].plannedStart-i.value[3].plannedStart}),$.map((r,i)=>{let O={...r};return O.value[0]=S(b.length-i+1),O}),e==="Date"){let r={series:[{name:"Baseline",type:"custom",data:h,large:!0,renderItem:n,encode:{x:[1,2],y:0,labal:11},label:{normal:{show:s,color:"black",position:"inside",formatter:function(i){return i.data.name},fontSize:12}}},{name:"New",type:"custom",data:$,large:!0,renderItem:n,encode:{x:[1,2],y:0},label:{normal:{show:s,color:"black",position:"inside",formatter:function(i){return i.data.name},fontSize:12}}}]};t.setOption(r),t.off("datazoom"),t.on("datazoom",function(i){F(i,h,$,s)}),console.log("成功")}else{let r={series:[{name:"Baseline",type:"custom",data:D,large:!0,renderItem:n,encode:{x:[1,2],y:0,labal:11},label:{normal:{show:s,color:"black",position:"inside",formatter:function(i){return i.data.name},fontSize:12}}},{name:"New",type:"custom",data:b,large:!0,renderItem:n,encode:{x:[1,2],y:0},label:{normal:{show:s,color:"black",position:"inside",formatter:function(i){return i.data.name},fontSize:12}}}]};t.setOption(r),t.off("datazoom"),t.on("datazoom",function(i){F(i,D,b,s)})}});function F(e,l,u,m){m||(e.batch[0].end-e.batch[0].start<30/u.length*100?t.setOption({series:[{name:"Baseline",type:"custom",data:l,large:!0,renderItem:n,encode:{x:[1,2],y:0,labal:11},label:{normal:{show:!0,color:"black",position:"inside",formatter:function(r){return r.data.name},fontSize:12}}},{name:"New",type:"custom",data:u,large:!0,renderItem:n,encode:{x:[1,2],y:0},label:{normal:{show:!0,color:"black",position:"inside",formatter:function(r){return r.data.name},fontSize:12}}}]}):t.setOption({series:[{name:"baseline",type:"custom",data:l,large:!0,renderItem:n,encode:{x:[1,2],y:0,labal:11},label:{normal:{show:!1,color:"black",position:"inside",formatter:function(r){return r.data.name},fontSize:12}}},{name:"new",type:"custom",data:u,large:!0,renderItem:n,encode:{x:[1,2],y:0},label:{normal:{show:!1,color:"black",position:"inside",formatter:function(r){return r.data.name},fontSize:12}}}]}))}t.on("mousemove",function(e){t.dispatchAction({type:"highlight",dataIndex:e.dataIndex})}),y=v.init(document.getElementById("myEcharts01"),"purple-passion"),y.on("mousemove",function(e){y.dispatchAction({type:"highlight",name:e.name})}),y.on("click",function(e){y.dispatchAction({type:"select",name:e.name})})}let A=V("");function X(a){if(!a)return"0.00";var a=Math.round(parseFloat(a)*100)/100,n=a.toString().split(".");if(n.length==1)return a=a.toString()+".00",a;if(n.length>1)return n[1].length<2&&(a=a.toString()+"0"),a}function ae(t,a){return t.reduce(function(n,s){let h=s[a];return n[h]||(n[h]=[]),n[h].push(s),n},{})}let ne=M(()=>{let t=o.selectedData.baselineResources.map(n=>({id:n.id,name:n.name,type:n.type})),a=ae(t,"type");if(A.value){const n=new RegExp(A.value,"i");let s={};for(let h in a)s[h]=a[h].filter($=>n.test($.name));return s}else return a}),re=M(()=>{var n;const t=o.selectedData.baselineResources;let a="base";return I.value?[t.filter(h=>h.id&&h.id===I.value)[0].distribution,a]:t.length==0?[]:(I.value=t[0].id,[(n=t[0])==null?void 0:n.distribution,a])}),oe=M(()=>{var n;const t=o.selectedData.newResources;let a="new";return I.value?[t.filter(h=>h.id&&h.id===I.value)[0].distribution,a]:t.length==0?[]:[(n=t[0])==null?void 0:n.distribution,a]}),ie=M(()=>({toolbox:{feature:{dataView:{show:!0,readOnly:!1},saveAsImage:{show:!0}}},dataZoom:[{type:"slider",filterMode:"none"},{type:"slider",filterMode:"none"},{type:"inside",filterMode:"none"},{type:"inside",filterMode:"none"}],tooltip:{trigger:"axis",axisPointer:{type:"cross"}},animation:!1,legend:{data:["Baseline","New"]},xAxis:{name:"date",type:"time",axisLabel:{formatter:"{yyyy}-{MM}-{dd}"}},yAxis:{name:"units / day"},series:[{name:"Baseline",type:"bar",data:p(re.value),large:!0,selectedMode:"single",select:{itemStyle:{color:"red",borderWidth:"5px"}},emphasis:{focus:"self",blurScope:"coordinateSystem"}},{name:"New",type:"bar",data:p(oe.value),large:!0,selectedMode:"single",select:{itemStyle:{color:"red",borderWidth:"5px"}},emphasis:{focus:"series",blurScope:"coordinateSystem"}}]}));function W(){y.setOption(ie.value)}H(B,()=>{W()});async function se(){f.push({name:"OptimizedReport"}),o.active=3}let I=V("");function le(){f.push({name:"BaselineSummary"}),o.active=1}function de(t){I.value=t}return H(I,()=>{W()}),(t,a)=>{const n=xe,s=we,h=be,$=ve("v-btn");return T(),L(Y,null,[c("div",Ie,[c("div",Oe,[c("h2",null,[q(w(t.$t("optimizedSummary.title[0]"))+" ",1),c("span",Ne,w(d(o).SummaryData.group.replace("_"," ").replace("base","Base")),1),c("div",Re,[c("span",null,w(d(o).setting.Steps)+" "+w(t.$t("optimizedSummary.title[1]")),1)]),c("div",Be,[c("span",null,w(`${d(o).setting.Ratio[0]*100}% - ${d(o).setting.Ratio[1]*100}% ${t.$t("optimizedSummary.title[2]")}`),1)])]),c("div",Ve,[g(j,{title:t.$t("optimizedSummary.header[0]"),height:180,precent:Z(d(o).SummaryData.changedDuration-d(o).SummaryData.baseDuration,d(o).SummaryData.baseDuration),isPositive:!0,body:[d(o).SummaryData.changedDuration+" days",d(o).SummaryData.baseDuration+" days",d(o).SummaryData.planDurationDays+" days"]},null,8,["title","precent","body"]),g(j,{title:t.$t("baselineSummary.Tsidebar[1]"),height:180,precent:Z(d(o).SummaryData.maxResourceUnit-d(o).SummaryData.BasemaxResourceUnit,d(o).SummaryData.BasemaxResourceUnit),isPositive:!0,body:[d(o).SummaryData.maxResourceUnit,d(o).SummaryData.BasemaxResourceUnit]},null,8,["title","precent","body"]),g(j,{title:t.$t("optimizedSummary.header[2]"),height:180,body:[d(o).SummaryData.changgedTasks,d(o).SummaryData.TotalTasks]},null,8,["title","body"]),g(j,{title:t.$t("optimizedSummary.header[3]"),height:180,body:[d(o).SummaryData.changedCriticalPath,d(o).SummaryData.changedCriticalPath,d(o).SummaryData.baseCriticalPath]},null,8,["title","body"])]),c("div",Fe,[c("div",Me,[c("div",null,w(t.$t("optimizedSummary.chartName[0]")),1),c("div",null,[g(s,{modelValue:d(R),"onUpdate:modelValue":a[0]||(a[0]=S=>G(R)?R.value=S:R=S),class:"m-2",placeholder:"Select",size:"large"},{default:E(()=>[g(n,{label:"Sort by Date",value:"Date"}),g(n,{label:"Original Order",value:"Original"})]),_:1},8,["modelValue"]),g(s,{modelValue:d(z),"onUpdate:modelValue":a[1]||(a[1]=S=>G(z)?z.value=S:z=S),class:"m-2",placeholder:"Select",size:"large"},{default:E(()=>[g(n,{label:"Compare Mode",value:"Compare"}),g(n,{label:"Separate Mode",value:"Separate"})]),_:1},8,["modelValue"])])]),c("span",null,w(t.$t("optimizedSummary.chartName[1]")),1),Ue,c("div",Ae,null,512)]),c("div",Te,[c("div",Ee,[c("div",null,w(t.$t("optimizedSummary.chartName[2]")),1)]),c("span",null,w(t.$t("optimizedSummary.chartName[3]")),1),g(h,{modelValue:d(A),"onUpdate:modelValue":a[2]||(a[2]=S=>G(A)?A.value=S:A=S),placeholder:"Search Resources"},null,8,["modelValue"]),(T(!0),L(Y,null,ee(d(ne),(S,F)=>(T(),L("div",null,[c("div",Pe,w(F)+" Resources",1),c("div",Ze,[(T(!0),L(Y,null,ee(S,(e,l)=>(T(),L("div",{key:l,class:"type"},[g($,{variant:"text",value:l,class:Se({activeType:d(I)==e.id}),onClick:()=>{de(e.id)}},{default:E(()=>[q(w(e.name)+" "+w(e.type),1)]),_:2},1032,["value","class","onClick"])]))),128))])]))),256)),c("div",Je,null,512)]),c("div",Le,[g($,{onClick:le,class:"btnback"},{default:E(()=>[q("BACK")]),_:1}),g(De,{style:"color:white;margin-left:1050px",disabled:!0,onClicked:se,title:t.$t("optimizedSummary.btn[1]")},null,8,["title"])])])]),g(Ce,{onCloseDialog:U,data:d(P),dialogVisible:d(_)},null,8,["data","dialogVisible"])],64)}}},Qe=me(He,[["__scopeId","data-v-01e26f3a"]]);export{Qe as default};
